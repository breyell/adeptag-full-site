{# Featured Article #}
{% if featured_article %}
  {% set featured_article = fn('Timber::get_post', featured_article) %}
{% endif %}

{% if featured_article %}
  <section class="bg-gray-background pt-6 pb-16 lg:pt-9">
    <div class="fluid-grid gap-y-4.5">
      <div class="span-content">
        <h1 class="text-h5 text-blue-dark pb-4 border-b border-b-blue-dark lg:pb-2">{{ post.title }}</h1>
      </div>
      <div class="span-content space-y-4.5 lg:space-y-8 lg:col-start-[content-start] lg:col-end-[col-7] lg:self-center">
        <div class="flex gap-5">
          <span class="text-tag text-blue-dark">{{ featured_article.date }}</span>
        </div>
        <h2 class="text-h3 text-blue-dark">{{ featured_article.title }}</h2>
        <p class="hidden lg:block text-b1 text-blue-dark">{{ featured_article.article_preview }}</p>
        <div class="hidden lg:block">
          {% include "partials/link.twig" with {
            title: 'Read More',
            url: featured_article.link,
            class: 'button-primary',
          } %}
        </div>
      </div>
      {% if featured_article.featured_image %}
        <div class="span-content lg:col-start-[col-8] lg:col-end-[content-end] lg:self-center">
          {{ ResponsiveImage(featured_article.featured_image, {
            class: 'w-full',
            sizes: '(min-width: 1024px) 35vw, (min-width: 1408px) 386px, 100vw',
            fetchpriority: 'high',
          }) }}
        </div>
      {% endif %}
      <div class="span-content space-y-4.5 lg:hidden">
        {% if featured_article.article_preview %}
        <p class="t ext-b1 text-blue-dark">{{ featured_article.article_preview }}</p>
        {% endif %}
        <div class="">
          {% include "partials/link.twig" with {
            title: 'Read More',
            url: featured_article.link,
            class: 'button-primary',
          } %}
        </div>
      </div>
    </div>
  </section>
{% endif %}

{# Blog Filter #}
{% set posts = fn('Timber::get_posts', {
  post_type: 'blog',
	posts_per_page: -1,
}) %}

<section
  x-data="blogFilter({{ posts|json_encode|e }})"
  x-resize="width = $width"
  class="py-10"
>
  <div class="fluid-grid mt-6 lg:mt-12">
    <div
      x-auto-animate
      class="span-content grid grid-cols-subgrid gap-y-4"
    >
      <template x-for="post in displayedPosts">
        <div class="col-span-12 md:col-span-6 lg:col-span-4">
          <a
            class="group"
            :href="post.link"
          >
            <template x-if="post.featured_image.src">
              <div class="relative w-full aspect-4/3 mb-4.5 rounded-md overflow-hidden transition-all group-hover:rounded-4xl">
                <img
                  :src="post.featured_image.src"
                  :alt="post.featured_image.alt"
                  :srcset="post.featured_image.srcset"
                  :width="post.featured_image.width"
                  :height="post.featured_image.height"
                  class="size-full"
                  :class="post.crop_image ? 'object-cover' : 'object-contain'"
                  sizes="(min-width: 768px) 50vw, (min-width: 1024px) 30vw, (min-width: 1408px) 405px, 100vw"
                  loading="lazy"
                >
                <div class="absolute z-10 top-0 left-0 size-full gradient-adeptag bg-linear-to-r opacity-0 mix-blend-screen pointer-events-none transition-all group-hover:opacity-90"></div>
              </div>
            </template>
            <div class="space-y-3">
              <div class="flex flex-wrap gap-6">
                <span
                  x-text="post.date"
                  class="text-tag text-blue-dark"
                ></span>
              </div>
              <h3
                x-html="post.title"
                class="text-b1 font-bold text-blue-dark"
              ></h3>
              <div
                x-text="post.article_preview"
                class="text-b2 text-blue-dark line-clamp-3"
              ></div>
            </div>
          </a>
        </div>
      </template>
    </div>
    <div class="span-content">
      {% include "partials/pagination.twig" with { items: posts } %}
    </div>
  </div>
</section>
